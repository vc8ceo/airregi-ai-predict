# データディクショナリ

## 概要

本ドキュメントは、Airレジから出力されるジャーナル履歴CSVデータの構造と内容を定義します。

## データソース

- **ファイル名**: `ジャーナル履歴_YYYYMMDD-YYYYMMDD.csv`
- **エンコーディング**: CP932 (Shift-JIS)
- **形式**: CSV（カンマ区切り）
- **データ粒度**: 商品明細レベル（1行 = 1商品）
- **取得期間**: 直近3ヶ月分のみダウンロード可能

## 基本統計（サンプルデータ: 2025/08/02 - 2025/10/13）

| 項目 | 値 |
|------|-----|
| 営業日数 | 20日 |
| 取引数（伝票数） | 1,121件 |
| 明細行数 | 6,259行 |
| 総売上額 | 52,229円 |
| 平均客単価 | 約47円 |
| 1日平均来店数 | 56.0組 |
| 1日平均売上 | 2,611円 |

## データ構造

### 主要カラム定義（全70列）

#### 1. 取引識別情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 0 | 伝票No | 文字列 | 取引を一意に識別する伝票番号 | 000220250802080220476 |
| 1 | 伝票補No | 文字列 | 伝票の補助番号（通常空欄） | - |
| 2 | 売上日 | 日付 | 取引が発生した日付 | 2025/08/02 |
| 3 | 売上日時 | 時刻 | 取引が発生した時刻 | 08:04:03 |
| 4 | 入力日 | 日付 | データ入力日 | 2025/08/02 |
| 5 | 入力日時 | 時刻 | データ入力時刻 | 08:04:03 |

#### 2. 店舗・レジ情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 6 | 店舗番号 | 文字列 | 店舗を識別する番号 | AKR5926017413 |
| 7 | 店舗名 | 文字列 | 店舗名称 | ひとつぶフーペンズ月光100円台 |
| 8 | 取引区分 | 文字列 | 取引の種類（通常/返品等） | 通常 |
| 9 | レジ番号 | 文字列 | レジ端末の番号 | 0002 |
| 10 | レジ担当者番号 | 文字列 | レジ担当スタッフの番号 | 0001 |
| 11 | レジ担当者名 | 文字列 | レジ担当スタッフの名前 | 佐々木乃愛 |

#### 3. 商品情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 12 | 商品名 | 文字列 | 販売した商品の名称 | オリーブパン |
| 13 | バリエーション項目1 | 文字列 | 商品バリエーション（オプション等） | - |
| 14 | バリエーション項目2 | 文字列 | 商品バリエーション（オプション等） | - |
| 15 | 販売単価 | 数値 | 商品1個あたりの販売価格（税抜） | 150 |
| 16 | 商品単価 | 数値 | 商品1個あたりの原価 | - |
| 17 | 販売数量 | 数値 | 販売した商品の数量 | 2 |
| 18 | 商品額 | 数値 | 単価×数量（税抜） | 300 |
| 19 | 商品額合計額 | 数値 | 商品額の合計 | - |

#### 4. 割引情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 20 | 割引率・割引額 | 文字列 | 割引の種類（率/額） | - |
| 21 | 通常割引・割引額/率 | 数値 | 割引の値 | 0 |
| 22 | 単位 | 文字列 | 割引単位（%/円） | - |
| 23 | 通常割引・適用数 | 数値 | 割引適用回数 | 0 |
| 24 | 通常割引・割引額合計額 | 数値 | 割引の合計金額 | 0 |

#### 5. まとめ売り情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 25 | まとめ売り割引数量 | 数値 | まとめ売り数量 | 0 |
| 26 | まとめ売り割引セット単価 | 数値 | セット単価 | 0 |
| 27 | まとめ売り割引セット数 | 数値 | セット数 | 0 |
| 28 | まとめ売り割引適用数 | 数値 | 適用数 | 0 |
| 29 | まとめ売り割引額合計額 | 数値 | 合計割引額 | 0 |

#### 6. 会計情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 30 | 小計点数 | 数値 | 伝票内の商品点数合計 | 6 |
| 31 | 小計 | 数値 | 伝票の小計金額（税抜） | 1,023 |
| 32 | 預り金額 | 数値 | 顧客から預かった金額 | 0 |
| 33-39 | ポイント・クーポン関連 | 数値 | 各種ポイント・クーポン情報 | 0 |
| 40 | 合計 | 数値 | 伝票の合計金額（税込前） | 1,104 |

#### 7. 税金情報

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 41 | 消費税額 | 数値 | 消費税の合計額 | 81 |
| 42 | 合計(10%対象) | 数値 | 10%税率対象の合計額 | 0 |
| 43 | 消費税額(10%対象) | 数値 | 10%税率の税額 | 0 |
| 44 | 合計(8%対象) | 数値 | 8%税率対象の合計額 | 0 |
| 45 | 消費税額(8%対象) | 数値 | 8%税率の税額 | 0 |
| 46 | 合計(8%軽減) | 数値 | 8%軽減税率対象の合計額 | 0 |
| 47 | 消費税額(8%軽減) | 数値 | 8%軽減税率の税額 | 0 |
| 48 | 合計(非課税) | 数値 | 非課税対象の合計額 | 1,104 |

#### 8. 支払方法（列49-67）

| 列番号 | カラム名 | データ型 | 説明 |
|--------|----------|----------|------|
| 49 | 現金 | 数値 | 現金支払い額 |
| 50 | クレジットカード(Airペイ) | 数値 | Airペイクレカ決済額 |
| 51 | PayPay(ペイペイ) | 数値 | PayPay決済額 |
| 52 | ICHICO(イチコ) | 数値 | ICHICO決済額 |
| 53 | QR決済(Airペイ QR) | 数値 | QR決済額 |
| 54 | 交通系電子マネー(Airペイ) | 数値 | 交通系IC決済額 |
| 55 | iD(Airペイ) | 数値 | iD決済額 |
| 56 | QUICPay(Airペイ) | 数値 | QUICPay決済額 |
| 57-67 | その他決済方法 | 数値 | その他各種決済方法 |

#### 9. 会計金額

| 列番号 | カラム名 | データ型 | 説明 | 例 |
|--------|----------|----------|------|-----|
| 68 | 現金預り金額 | 数値 | 現金で預かった金額 | 1,104 |
| 69 | お釣り金額 | 数値 | 返却したお釣りの金額 | 0 |

## データの特徴

### 1. データ粒度
- **明細レベル**: 1行が1商品の販売記録
- **伝票レベル**: 同じ伝票Noでグループ化することで取引単位に集約可能

### 2. 集約パターン

#### 日次集約（予測の目的変数）
```
- 来店数: COUNT(DISTINCT 伝票No) GROUP BY 売上日
- 売上金額: SUM(小計 + 消費税額) GROUP BY 売上日
```

#### 時間帯分析
```
- 営業時間: 売上日時から抽出
- ピークタイム識別: 時間帯別の取引数分析
```

### 3. 欠損値と制約
- バリエーション項目は多くの場合空欄
- 割引は適用がない場合は0
- 支払方法は使用された決済手段のみ値が入る

## データ品質に関する注意事項

1. **文字エンコーディング**: CP932（Shift-JIS）を使用しているため、UTF-8への変換が必要
2. **データ取得制限**: 直近3ヶ月分のみダウンロード可能
3. **履歴データの蓄積**: 長期予測のために定期的なバックアップが必要
4. **営業日の定義**: 休業日はデータに含まれない

## 予測モデルで使用する特徴量

### 目的変数
1. **来店数**: 1日あたりの取引数（伝票数）
2. **売上金額**: 1日あたりの総売上（税込）

### 説明変数（派生特徴量）
1. **時系列特徴**
   - 曜日（月〜日）
   - 月
   - 祝日フラグ
   - 週番号
   - 季節（春夏秋冬）

2. **過去実績特徴**
   - 前日の来店数・売上
   - 1週間前の来店数・売上
   - 過去7日間の平均来店数・売上
   - 過去30日間の平均来店数・売上

3. **外部データ（天気情報）**
   - 天候（晴れ/曇り/雨/雪）
   - 最高気温
   - 最低気温
   - 降水確率
   - 風速

## 更新履歴

| 日付 | バージョン | 更新内容 | 作成者 |
|------|------------|----------|--------|
| 2025-10-13 | 1.0 | 初版作成 | Claude |
